<?xml version="1.0" ?>
<robot name="Phantom_X" xmlns:xacro="http://www.ros.org/wiki/xacro">

    <xacro:property name="M_PI" value="3.1415926535897931" />

    <link name="world" />

    <!-- Base -->
    <link name="base_link">
        <visual>
            <origin rpy="0 0 0" xyz="0 0 0.000" />
            <geometry>
                <mesh filename="package://phantomx_description/models/phantomx_pincher/meshes/visual/base.dae" scale="1.0 1.0 1.0" />
            </geometry>
        </visual>
        <inertial>
            <mass value="0.352" />
            <origin xyz="-0.027277 -0.000052 0.042715" rpy="0 0 0" />
            <inertia ixx="0.662213" iyy="0.758616" izz="0.717514" ixy="0.000438" ixz="-0.133928" iyz="-0.000837" />
        </inertial>
        <collision>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://phantomx_description/models/phantomx_pincher/meshes/collision/simple_base.dae" scale="1.0 1.0 1.0" />
            </geometry>
        </collision>
    </link>
    <joint name="base_joint" type="fixed">
        <parent link="world" />
        <child link="base_link" />
    </joint>

    <!-- Shoulder -->
    <link name="shoulder_link">
        <visual>
            <origin rpy="0 0 ${M_PI/2}" xyz="0 0 0" />
            <geometry>
                <mesh filename="package://phantomx_description/models/phantomx_pincher/meshes/visual/shoulder.dae" scale="1.0 1.0 1.0" />
            </geometry>
        </visual>
        <inertial>
            <mass value="0.118" />
            <origin xyz="0.001031 -0.000032 -0.013806" rpy="0 0 0" />
            <inertia ixx="0.030893" iyy="0.036432" izz="0.018984" ixy="0.000002" ixz="-0.000383" iyz="-0.000026" />
        </inertial>
        <collision>
            <origin rpy="0 0 ${M_PI/2}" xyz="0 0 0" />
            <geometry>
                <mesh filename="package://phantomx_description/models/phantomx_pincher/meshes/collision/simple_shoulder.dae" scale="1.0 1.0 1.0" />
            </geometry>
        </collision>
    </link>
    <joint name="shoulder_joint" type="revolute">
        <axis xyz="0 0 1" />
        <limit effort="1000.0" lower="-2.617993" upper="2.617993" velocity="0.5" />
        <origin rpy="0 0 0" xyz="0 0 0.137" />
        <parent link="base_link" />
        <child link="shoulder_link" />
    </joint>

    <!-- Lower Arm -->
    <link name="lower_arm_link">
        <visual>
            <origin rpy="0 0 0" xyz="0 0 0" />
            <geometry>
                <mesh filename="package://phantomx_description/models/phantomx_pincher/meshes/visual/lower_arm.dae" scale="1.0 1.0 1.0" />
            </geometry>
        </visual>
        <inertial>
            <mass value="0.162" />
            <origin xyz="0.080988 -0.000023 -0.000748" rpy="0 0 0" />
            <inertia ixx="0.031204" iyy="0.124182" izz="0.111578" ixy="0.00002" ixz="0.001864" iyz="-0.000003" />
        </inertial>
        <collision>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://phantomx_description/models/phantomx_pincher/meshes/collision/simple_bicep.dae" scale="1.0 1.0 1.0" />
            </geometry>
        </collision>
    </link>
    <joint name="lower_arm_joint" type="revolute">
        <axis xyz="0 0 1" />
        <limit effort="1000.0" lower="-2.617993" upper="2.617993" velocity="0.5" />
        <origin rpy="${M_PI/2} -${M_PI/2} 0" xyz="0 0 0" />
        <parent link="shoulder_link" />
        <child link="lower_arm_link" />
    </joint>

    <!-- Upper Arm -->
    <link name="upper_arm_link">
        <visual>
            <origin rpy="0 0 0" xyz="0 0 0" />
            <geometry>
                <mesh filename="package://phantomx_description/models/phantomx_pincher/meshes/visual/upper_arm.dae" scale="1.0 1.0 1.0" />
            </geometry>
        </visual>
        <inertial>
            <mass value="0.162" />
            <origin xyz="0.080988 -0.000023 -0.000748" rpy="0 0 0" />
            <inertia ixx="0.031204" iyy="0.124182" izz="0.111578" ixy="0.00002" ixz="0.001864" iyz="-0.000003" />
        </inertial>
        <collision>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://phantomx_description/models/phantomx_pincher/meshes/collision/simple_bicep.dae" scale="1.0 1.0 1.0" />
            </geometry>
        </collision>
    </link>
    <joint name="upper_arm_joint" type="revolute">
        <axis xyz="0 0 1" />
        <limit effort="1000.0" lower="-2.617993" upper="2.617993" velocity="0.5" />
        <origin rpy="0 0 0" xyz="0.105 0 0" />
        <parent link="lower_arm_link" />
        <child link="upper_arm_link" />
    </joint>

    <!-- Gripper Body -->
    <link name="wrist_link">
        <visual>
            <origin rpy="0 0 0" xyz="0 0 0" />
            <geometry>
                <mesh filename="package://phantomx_description/models/phantomx_pincher/meshes/visual/gripper_body.dae" scale="1.0 1.0 1.0" />
            </geometry>
        </visual>
        <inertial>
            <mass value="0.160" />
            <origin xyz="0.047054 0.009939 -0.000023" rpy="0 0 0" />
            <inertia ixx="0.053897" iyy="0.057629" izz="0.068868" ixy="-0.002353" ixz="0.000011" iyz="0.000041" />
        </inertial>
        <collision>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://phantomx_description/models/phantomx_pincher/meshes/collision/simple_wrist.dae" scale="1.0 1.0 1.0" />
            </geometry>
        </collision>
    </link>
    <joint name="wrist_joint" type="revolute">
        <axis xyz="0 0 1" />
        <origin rpy="0 0 0" xyz="0.105 0 0" />
        <limit effort="1000.0" lower="-2.617993" upper="2.617993" velocity="0.5" />
        <parent link="upper_arm_link" />
        <child link="wrist_link" />
    </joint>

    <!-- Finger_1 -->
    <link name="finger_1_link">
        <visual>
            <origin rpy="0 0 0" xyz="0 0 0" />
            <geometry>
                <mesh filename="package://phantomx_description/models/phantomx_pincher/meshes/visual/finger.dae" scale="1.0 1.0 1.0" />
            </geometry>
        </visual>
        <inertial>
            <mass value="0.018" />
            <origin xyz="0.010769 0 -0.007406" rpy="0 0 0" />
            <inertia ixx="0.002959" iyy="0.00287" izz="0.004524" ixy="0" ixz="-0.000707" iyz="0" />
        </inertial>
        <collision>
            <origin rpy="0 0 0" xyz="0 0 0" />
            <geometry>
                <mesh filename="package://phantomx_description/models/phantomx_pincher/meshes/collision/simple_finger.dae" scale="1.0 1.0 1.0" />
            </geometry>
        </collision>
    </link>
    <joint name="finger_1_joint" type="prismatic">
        <axis xyz="0 0 1" />
        <origin rpy="0 0 0" xyz="0.071844 0 0" />
        <limit effort="1000.0" lower="0" upper="0.015" velocity="0.5" />
        <parent link="wrist_link" />
        <child link="finger_1_link" />
    </joint>

    <!-- Finger_2 -->
    <link name="finger_2_link">
        <visual>
            <origin rpy="0 0 0" xyz="0 0 0" />
            <geometry>
                <mesh filename="package://phantomx_description/models/phantomx_pincher/meshes/visual/finger.dae" scale="1.0 1.0 1.0" />
            </geometry>
        </visual>
        <inertial>
            <mass value="0.018" />
            <origin xyz="0.010769 0 -0.007406" rpy="0 0 0" />
            <inertia ixx="0.002959" iyy="0.00287" izz="0.004524" ixy="0" ixz="-0.000707" iyz="0" />
        </inertial>
        <collision>
            <origin rpy="0 0 0" xyz="0 0 0" />
            <geometry>
                <mesh filename="package://phantomx_description/models/phantomx_pincher/meshes/collision/simple_finger.dae" scale="1.0 1.0 1.0" />
            </geometry>
        </collision>
    </link>
    <joint name="finger_2_joint" type="prismatic">
        <axis xyz="0 0 1" />
        <origin rpy="${M_PI} 0 0" xyz="0.071844 0 0" />
        <limit effort="1000.0" lower="0" upper="0.015" velocity="0.5" />
        <parent link="wrist_link" />
        <child link="finger_2_link" />
        <mimic joint="finger_1_joint" multiplier="1" offset="0" />
    </joint>

    <!-- Tool -->
    <link name="tool_link">
        <inertial>
            <mass value="0.0001" />
            <origin xyz="0 0 0" />
            <inertia ixx="0.00001" iyy="0.00001" izz="0.00001" ixy="0.0" ixz="0.0" iyz="0.0" />
        </inertial>
    </link>
    <joint name="tool_joint" type="fixed">
        <axis xyz="0 0 1" />
        <origin rpy="${M_PI} -${M_PI/2} 0" xyz="0.110 0 0" />
        <parent link="wrist_link" />
        <child link="tool_link" />
    </joint>

    <!-- Transmissions -->
    <transmission name="trans_shoulder_joint">
        <type>transmission_interface/SimpleTransmission</type>
        <joint name="shoulder_joint">
            <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
        </joint>
        <actuator name="shoulder_joint_motor">
            <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
            <mechanicalReduction>1</mechanicalReduction>
        </actuator>
    </transmission>

    <transmission name="trans_lower_arm_joint">
        <type>transmission_interface/SimpleTransmission</type>
        <joint name="lower_arm_joint">
            <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
        </joint>
        <actuator name="lower_arm_joint_motor">
            <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
            <mechanicalReduction>1</mechanicalReduction>
        </actuator>
    </transmission>

    <transmission name="trans_upper_arm_joint">
        <type>transmission_interface/SimpleTransmission</type>
        <joint name="upper_arm_joint">
            <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
        </joint>
        <actuator name="upper_arm_joint_motor">
            <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
            <mechanicalReduction>1</mechanicalReduction>
        </actuator>
    </transmission>

    <transmission name="trans_wrist_joint">
        <type>transmission_interface/SimpleTransmission</type>
        <joint name="wrist_joint">
            <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
        </joint>
        <actuator name="wrist_joint_motor">
            <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
            <mechanicalReduction>1</mechanicalReduction>
        </actuator>
    </transmission>

    <transmission name="trans_finger_1_joint">
        <type>transmission_interface/SimpleTransmission</type>
        <joint name="finger_1_joint">
            <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
        </joint>
        <actuator name="finger_1_joint_motor">
            <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
            <mechanicalReduction>1</mechanicalReduction>
        </actuator>
    </transmission>

    <transmission name="trans_finger_2_joint">
        <type>transmission_interface/SimpleTransmission</type>
        <joint name="finger_2_joint">
            <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
        </joint>
        <actuator name="finger_2_joint_motor">
            <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
            <mechanicalReduction>1</mechanicalReduction>
        </actuator>
    </transmission>

    <!-- Gazebo Plugins -->
    <gazebo>
        <plugin name="gazebo_ros_control" filename="libgazebo_ros_control.so" />
    </gazebo>
    <gazebo>
        <plugin name="joint_state_publisher" filename="libgazebo_ros_joint_state_publisher.so">
            <jointName>shoulder_joint, lower_arm_joint, upper_arm_joint, wrist_joint, finger_1_joint, finger_2_joint</jointName>
        </plugin>
    </gazebo>
    <gazebo>
        <plugin name="gazebo_grasp_fix" filename="libgazebo_grasp_fix.so">
            <arm>
                <arm_name>Phantom_X</arm_name>
                <palm_link> wrist_link  </palm_link>
                <gripper_link> finger_1_link </gripper_link>
                <gripper_link> finger_2_link </gripper_link>
            </arm>
            <forces_angle_tolerance>100</forces_angle_tolerance>
            <update_rate>100</update_rate>
            <grip_count_threshold>4</grip_count_threshold>
            <max_grip_count>8</max_grip_count>
            <release_tolerance>0.001</release_tolerance>
            <disable_collisions_on_attach>false</disable_collisions_on_attach>
            <contact_topic>__default_topic__</contact_topic>
        </plugin>
    </gazebo>

</robot>